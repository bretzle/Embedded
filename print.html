<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Embedded Manual</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="hardware.html"><strong aria-hidden="true">2.</strong> Hardware Setup</a></li><li class="chapter-item expanded "><a href="components.html"><strong aria-hidden="true">3.</strong> Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="components/buttons.html"><strong aria-hidden="true">3.1.</strong> Push Buttons</a></li><li class="chapter-item expanded "><a href="components/switches.html"><strong aria-hidden="true">3.2.</strong> Switches</a></li><li class="chapter-item expanded "><a href="components/led.html"><strong aria-hidden="true">3.3.</strong> LEDs</a></li><li class="chapter-item expanded "><a href="components/sev_seg.html"><strong aria-hidden="true">3.4.</strong> Seven Segment</a></li><li class="chapter-item expanded "><a href="components/servo.html"><strong aria-hidden="true">3.5.</strong> Servo</a></li><li class="chapter-item expanded "><a href="components/lcd.html"><strong aria-hidden="true">3.6.</strong> LCD Display</a></li><li class="chapter-item expanded "><a href="components/touch.html"><strong aria-hidden="true">3.7.</strong> LCD Touch</a></li><li class="chapter-item expanded "><a href="components/joystick.html"><strong aria-hidden="true">3.8.</strong> Joystick</a></li><li class="chapter-item expanded "><a href="components/accelerometer.html"><strong aria-hidden="true">3.9.</strong> Accelerometer</a></li></ol></li><li class="chapter-item expanded "><a href="conclusions.html"><strong aria-hidden="true">4.</strong> Summary &amp; Conclusions</a></li><li class="chapter-item expanded "><a href="api.html"><strong aria-hidden="true">5.</strong> Appendix I: API</a></li><li class="chapter-item expanded "><a href="example.html"><strong aria-hidden="true">6.</strong> Appendix II: Example</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Embedded Manual</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><em>This book can be read online at <a href="https://bretzle.github.io/Embedded/">https://bretzle.github.io/Embedded/</a></em></p>
<ul>
<li>Sell your system!</li>
<li>What can it do? </li>
<li>How was it designed? </li>
<li>What tools were used?</li>
</ul>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="./introduction.html">Introduction</a></li>
<li><a href="./hardware.html">Hardware Setup</a></li>
<li><a href="./components.html">Components</a>
<ul>
<li><a href="./components/buttons.html">Push Buttons</a></li>
<li><a href="./components/switches.html">Switches</a></li>
<li><a href="./components/led.html">LEDs</a></li>
<li><a href="./components/sev_seg.html">Seven Segment</a></li>
<li><a href="./components/servo.html">Servo</a></li>
<li><a href="./components/lcd.html">LCD Display</a></li>
<li><a href="./components/touch.html">LCD Touch</a></li>
<li><a href="./components/joystick.html">Joystick</a></li>
<li><a href="./components/accelerometer.html">Accelerometer</a></li>
</ul>
</li>
<li><a href="./conclusions.html">Summary &amp; Conclusions</a></li>
<li><a href="./api.html">Appendix I: API</a></li>
<li><a href="./example.html">Appendix II: Example</a></li>
</ul>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="hardware-setup"><a class="header" href="#hardware-setup">Hardware Setup</a></h1>
<h3 id="top-level-schematic"><a class="header" href="#top-level-schematic">Top level Schematic</a></h3>
<p><img src="https://cdn.discordapp.com/attachments/371689406823661570/842882954601824277/unknown.png" alt="Top Level Schematic" /></p>
<h3 id="board-block-diagram"><a class="header" href="#board-block-diagram">Board Block Diagram</a></h3>
<p><img src="https://cdn.discordapp.com/attachments/371689406823661570/843220247725080576/unknown.png" alt="Board Block Diagram" /></p>
<h3 id="overall-memory-map"><a class="header" href="#overall-memory-map">Overall Memory Map</a></h3>
<table><thead><tr><th>Component</th><th>Start</th><th>End</th></tr></thead><tbody>
<tr><td>LEDs</td><td><code>0xFF20_0000</code></td><td><code>0xFF20_000F</code></td></tr>
<tr><td>Switches</td><td><code>0xFF20_0040</code></td><td><code>0xFF20_004F</code></td></tr>
<tr><td>Pushbuttons</td><td><code>0xFF20_0050</code></td><td><code>0xFF20_005F</code></td></tr>
<tr><td>HexDecoder</td><td><code>0xFF20_2050</code></td><td><code>0xFF20_205F</code></td></tr>
<tr><td>Servos</td><td><code>0xFF20_2060</code></td><td><code>0xFF20_206F</code></td></tr>
<tr><td>LCD</td><td><code>0xFF20_2070</code></td><td><code>0xFF20_207F</code></td></tr>
<tr><td>Touch Control</td><td><code>0xFF20_2080</code></td><td><code>0xFF20_2087</code></td></tr>
<tr><td>Joystick Sequencer</td><td><code>0xFF20_2090</code></td><td><code>0xFF20_2097</code></td></tr>
<tr><td>Joystick Sample Store</td><td><code>0xFF20_2200</code></td><td><code>0xFF20_23FF</code></td></tr>
<tr><td>Accelerometer</td><td><code>0xFF20_2440</code></td><td><code>0xFF20_247F</code></td></tr>
</tbody></table>
<ul>
<li>Overall Block diagram of your complete system.</li>
<li>How would your wire up your system? </li>
<li>What pins go where?</li>
<li>Reference the schematic </li>
<li>Overall Memory Map</li>
</ul>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="components"><a class="header" href="#components">Components</a></h1>
<ul>
<li><a href="./components/buttons.html">Push Buttons</a></li>
<li><a href="./components/switches.html">Switches</a></li>
<li><a href="./components/led.html">LEDs</a></li>
<li><a href="./components/sev_seg.html">Seven Segment</a></li>
<li><a href="./components/servo.html">Servo</a></li>
<li><a href="./components/lcd.html">LCD Display</a></li>
<li><a href="./components/touch.html">LCD Touch</a></li>
<li><a href="./components/joystick.html">Joystick</a></li>
<li><a href="./components/accelerometer.html">Accelerometer</a></li>
</ul>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="push-buttons"><a class="header" href="#push-buttons">Push Buttons</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The board comes equiped with two push buttons.</p>
<h2 id="memory-map"><a class="header" href="#memory-map">Memory Map</a></h2>
<p>Each button takes up 2 bits in memory.</p>
<p>'1' is pressed. '0' is not pressed</p>
<pre><code>+----------+----------+
| Button 2 | Button 1 |
+----------+----------+
</code></pre>
<h2 id="theory-of-operation"><a class="header" href="#theory-of-operation">Theory of Operation</a></h2>
<p>Nothing needs to be initialized. Simply read the memory itself or use the api calls.</p>
<h2 id="hardware-connections"><a class="header" href="#hardware-connections">Hardware Connections</a></h2>
<p>The component is hardwired to the buttons on the board</p>
<h2 id="testing-and-usage"><a class="header" href="#testing-and-usage">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;pushbutton.h&quot;

while (1)
{
	if (is_button_pressed(BUTTON_1))
	{
		printf(&quot;Button 1 is pressed!\n&quot;);
	}
}
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="switches"><a class="header" href="#switches">Switches</a></h1>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>The DE10-Lite comes prequipped with 10 slide switches.</p>
<h2 id="memory-map-1"><a class="header" href="#memory-map-1">Memory Map</a></h2>
<p>The component utilizes 10 bits, 1 for each switch.</p>
<pre><code>+----------+-----+-----+----------+----------+----------+
| Switch 9 | ... | ... | Switch 2 | Switch 1 | Switch 0 |
+----------+-----+-----+----------+----------+----------+
</code></pre>
<h2 id="theory-of-operation-1"><a class="header" href="#theory-of-operation-1">Theory of Operation</a></h2>
<p>Nothing needs to be initialized. Simply read the memory itself or use the api calls.</p>
<h2 id="hardware-connections-1"><a class="header" href="#hardware-connections-1">Hardware Connections</a></h2>
<p>The components is hardwired to the switches on the board</p>
<h2 id="testing-and-usage-1"><a class="header" href="#testing-and-usage-1">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;switches.h&quot;

while (1)
{
	printf(&quot;Value: %d\n&quot;, read_switches());
}
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="leds"><a class="header" href="#leds">LEDs</a></h1>
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>There are 10 LEDs that can be controlled on the board</p>
<h2 id="memory-map-2"><a class="header" href="#memory-map-2">Memory Map</a></h2>
<p>The component utilizes 10 bits, 1 for each LED.</p>
<p>When a bit is high the LED will turn on.</p>
<pre><code>+-------+-----+-----+-------+-------+-------+
| LED 9 | ... | ... | LED 2 | LED 1 | LED 0 |
+-------+-----+-----+-------+-------+-------+
</code></pre>
<h2 id="theory-of-operation-2"><a class="header" href="#theory-of-operation-2">Theory of Operation</a></h2>
<p>Nothing needs to be initialized. Simply read the memory itself or use the api calls.</p>
<h2 id="hardware-connections-2"><a class="header" href="#hardware-connections-2">Hardware Connections</a></h2>
<p>The components is hardwired to the LEDs on the board</p>
<h2 id="testing-and-usage-2"><a class="header" href="#testing-and-usage-2">Testing and Usage</a></h2>
<pre><code class="language-c">write_leds(0x3FF); // Turns on all leds
write_leds(0x001); // Turns off all leds except the first
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="seven-segment"><a class="header" href="#seven-segment">Seven Segment</a></h1>
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>There are six seven-segment displays on the the DE10-Lite. Each display has its own decoder in hardware. These decoders support all hexadecimal characters.</p>
<h2 id="memory-map-3"><a class="header" href="#memory-map-3">Memory Map</a></h2>
<p>Each decoder is 5 bits in memory where the first 4 are the digit to display
and an enable bit. When the enable bit is set to 0 nothing will be displayed.</p>
<pre><code>Ex.
  +---+---+---+---+---+
  | 1 | 0 | 0 | 1 | 1 |   Would display 9 on the display
  +---+---+---+---+---+
   ^----Data----^   ^ Enable bit
  +---+---+---+---+---+
  | 1 | 0 | 0 | 1 | 0 |   No display
  +---+---+---+---+---+
</code></pre>
<h2 id="theory-of-operation-3"><a class="header" href="#theory-of-operation-3">Theory of Operation</a></h2>
<p>Nothing needs to be initialized. One can simply call the api's functions to write to each display.</p>
<h2 id="hardware-connections-3"><a class="header" href="#hardware-connections-3">Hardware Connections</a></h2>
<p>The decoders are built into the system itself and are hardwired to the displays.</p>
<h2 id="testing-and-usage-3"><a class="header" href="#testing-and-usage-3">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;seven_seg.h&quot;

write_hex_display(123456, 10); // writes &quot;123456&quot;

write_hex_display(0xDEADBEEF, 16); // writes &quot;DEADBEEF&quot;
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="servo"><a class="header" href="#servo">Servo</a></h1>
<h2 id="overview-4"><a class="header" href="#overview-4">Overview</a></h2>
<p>The system has two servo controllers that can control two independant hobby servo motors. </p>
<h2 id="memory-map-4"><a class="header" href="#memory-map-4">Memory Map</a></h2>
<p>Each servo is effectivly an 8-bit register.</p>
<h2 id="theory-of-operation-4"><a class="header" href="#theory-of-operation-4">Theory of Operation</a></h2>
<p>Nothing needs to be initialized in software.</p>
<p>The value determines the position of the servo. Eacg servo has <code>90</code>° of movement. When the register holds <code>0</code>-<code>200</code> the servo will move from <code>0</code>-<code>90</code>°. If the value is <code>&gt;200</code> the servo will &quot;turn off&quot; (Allowing free range of motion)</p>
<p>Internally the controller creates a pwm signal that will tell the servo the position to move to.</p>
<h2 id="hardware-connections-4"><a class="header" href="#hardware-connections-4">Hardware Connections</a></h2>
<p>Each servo will require a connection to VCC (+5V), GND, and an arduino pin to drive.</p>
<h2 id="testing-and-usage-4"><a class="header" href="#testing-and-usage-4">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;servo.h&quot;

// Move the first servo to 45° and the second to 90°
move_servos_degree(45, 90);
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="lcd-display"><a class="header" href="#lcd-display">LCD Display</a></h1>
<h2 id="overview-5"><a class="header" href="#overview-5">Overview</a></h2>
<p>The LCD component makes use of the LT24 Display. The display is 320x240 pixels and uses 16-bit color opposed to the traditional 24. The component makes use of Framebuffers in memory to handle pixel data.</p>
<h2 id="memory-map-5"><a class="header" href="#memory-map-5">Memory Map</a></h2>
<p>The component allocates 150 KibiBytes on the heap when the framebuffers are initialized. This data must be freed after use. </p>
<h2 id="theory-of-operation-5"><a class="header" href="#theory-of-operation-5">Theory of Operation</a></h2>
<p>The LCD will be automatically initialized when the system powers up. The display makes use of two framebuffers. The display has direct memory access to the frontbuffer. The buffers can be swapped by calling <code>lcd_present</code>. The display also supports touch interaction (<a href="components/./touch.html">See components/touch</a>).</p>
<h2 id="hardware-connections-5"><a class="header" href="#hardware-connections-5">Hardware Connections</a></h2>
<p>The display uses the entire 40 pin GPIO Bus. </p>
<p><em>More info can be found in the <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwiFgNTmhNHwAhURbc0KHZDBDokQFjAAegQIBRAD&amp;url=https%3A%2F%2Fwww.terasic.com.tw%2Fcgi-bin%2Fpage%2Farchive_download.pl%3FLanguage%3DEnglish%26No%3D892%26FID%3D527f33a451f2c9a404934446366f5342&amp;usg=AOvVaw01SB6SgxbhnAOCPr9bi4va">LT24 Datasheet</a></em></p>
<h2 id="testing-and-usage-5"><a class="header" href="#testing-and-usage-5">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;lcd.h&quot;

lcd_init(); // initialize the framebuffer

lcd_clear(); // clears the screen by setting every pixel to white

lcd_draw_rectangle(0, 0, WIDTH, HEIGHT, RED); // draws a red line from (0,0) to (WIDTH, HEIGHT) 

lcd_present(); // swaps the framebuffers and draws changes

lcd_free(); // Once done drawing free the framebuffers
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="lcd-touch"><a class="header" href="#lcd-touch">LCD Touch</a></h1>
<h2 id="overview-6"><a class="header" href="#overview-6">Overview</a></h2>
<p>The LT24 LCD display is also a touch screen.</p>
<h2 id="memory-map-6"><a class="header" href="#memory-map-6">Memory Map</a></h2>
<p>This component has a control register and a data register. Interacting with both of these should be done through the provided API.</p>
<h2 id="theory-of-operation-6"><a class="header" href="#theory-of-operation-6">Theory of Operation</a></h2>
<p>The touch subsystem of the LCD utilizes an ADC as well as an SPI bus to communicate with that ADC.</p>
<p>The LCD must be initialized via <code>touch_init()</code> prior to reading touch data.</p>
<h2 id="hardware-connections-6"><a class="header" href="#hardware-connections-6">Hardware Connections</a></h2>
<p>This subsystem uses the same pins as the LCD display. See LCD Display documentation for more <a href="components/./lcd.html">info</a></p>
<h2 id="testing-and-usage-6"><a class="header" href="#testing-and-usage-6">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;touch.h&quot;
#include &quot;lcd.h&quot;

lcd_init();
touch_init();

int32_t data[2];

// Make any pixel red that is touched
while (1)
{
	get_touch_data(data);
	set_pixel(data[0], data[1], RED)
}
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="joystick"><a class="header" href="#joystick">Joystick</a></h1>
<h2 id="overview-7"><a class="header" href="#overview-7">Overview</a></h2>
<p>An analog joystick similar to those found on game controllers. Allows vector based controls.</p>
<p><img src="https://cdn.discordapp.com/attachments/371689406823661570/843241408223772742/unknown.png" alt="Picture of joystick" /></p>
<h2 id="memory-map-7"><a class="header" href="#memory-map-7">Memory Map</a></h2>
<h2 id="theory-of-operation-7"><a class="header" href="#theory-of-operation-7">Theory of Operation</a></h2>
<p>The joystick makes use of a general purpose ADC. <code>Vrx</code>, <code>Vry</code> and <code>Sw</code> are connected to arduino ADC pins. Once the ADC is turned on the joystick inputs can be read by the system.</p>
<h2 id="hardware-connections-7"><a class="header" href="#hardware-connections-7">Hardware Connections</a></h2>
<table><thead><tr><th>Name</th><th>Direction</th><th>Purpose</th><th>Notes</th></tr></thead><tbody>
<tr><td>VCC</td><td>out</td><td>+5V connection</td><td></td></tr>
<tr><td>GND</td><td>out</td><td>ground connection</td><td></td></tr>
<tr><td>Vrx</td><td>in</td><td>Horizontal analog signal</td><td>Connects to A0</td></tr>
<tr><td>Vry</td><td>in</td><td>Vertical analog signal</td><td>Connects to A1</td></tr>
<tr><td>Sw</td><td>in</td><td>Clicking Switch</td><td>Connects to A2</td></tr>
</tbody></table>
<p><em>See DE10-Lite <a href="https://www.intel.com/content/dam/altera-www/global/en_US/portal/dsn/42/doc-us-dsnbk-42-2912030810549-de10-lite-user-manual.pdf">Manual</a> for FPGA pins</em></p>
<h2 id="testing-and-usage-7"><a class="header" href="#testing-and-usage-7">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;analog.h&quot;

int32_t data[2];

analog_init();
get_analog_data(data);

printf(&quot;X: %10d, Y: %10d\n&quot;, data[0], data[1]);
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="accelerometer"><a class="header" href="#accelerometer">Accelerometer</a></h1>
<h2 id="overview-8"><a class="header" href="#overview-8">Overview</a></h2>
<p>The accelerometer is a sensor build into the board that can detect movements on all 3 axes.</p>
<h2 id="memory-map-8"><a class="header" href="#memory-map-8">Memory Map</a></h2>
<h2 id="theory-of-operation-8"><a class="header" href="#theory-of-operation-8">Theory of Operation</a></h2>
<p>Internally the device uses an I2C bus to communicate with the rest of the system. The component must be initialized prior to retrieving data from the device. This device does not make use of interrupts.</p>
<h2 id="hardware-connections-8"><a class="header" href="#hardware-connections-8">Hardware Connections</a></h2>
<p>Uses the accelerometer's pins more specifically:</p>
<table><thead><tr><th>Name</th><th>Direction</th><th>Purpose</th></tr></thead><tbody>
<tr><td><code>G_SENSOR_SDO</code></td><td>inout</td><td>I2C address select</td></tr>
<tr><td><code>G_SENSOR_SDI</code></td><td>inout</td><td>I2C serial data</td></tr>
<tr><td><code>G_SENSOR_SCLK</code></td><td>inout</td><td>I2C serial clock</td></tr>
<tr><td><code>G_SENSOR_CS_N</code></td><td>out</td><td>Enables I2C communication</td></tr>
</tbody></table>
<p><em>See DE10-Lite <a href="https://www.intel.com/content/dam/altera-www/global/en_US/portal/dsn/42/doc-us-dsnbk-42-2912030810549-de10-lite-user-manual.pdf">Manual</a> for FPGA pins</em></p>
<h2 id="testing-and-usage-8"><a class="header" href="#testing-and-usage-8">Testing and Usage</a></h2>
<pre><code class="language-c">#include &quot;accel.h&quot;

accel_init();

int16_t data[3];

get_accel_data(data);
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="summary--conclusions"><a class="header" href="#summary--conclusions">Summary &amp; Conclusions</a></h1>
<p>what went well?</p>
<p>what diffuclties did you encouter?</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="appendix-i-api"><a class="header" href="#appendix-i-api">Appendix I: API</a></h1>
<h2 id="push-buttons-1"><a class="header" href="#push-buttons-1">Push Buttons</a></h2>
<pre><code class="language-c">#define BUTTON_1 1
#define BUTTON_2 2

/// Whether or not a button is pressed
///
/// Use `BUTTON_1` or `BUTTON_2`
int is_button_pressed(int button);
</code></pre>
<h2 id="switches-1"><a class="header" href="#switches-1">Switches</a></h2>
<pre><code class="language-c">/// Reads the value of all the switches
int read_switches(void);
</code></pre>
<h2 id="leds-1"><a class="header" href="#leds-1">LEDs</a></h2>
<pre><code class="language-c">/// Write a 10 bit value to the LEDs
void write_leds(int16_t leds);
</code></pre>
<h2 id="seven-segment-1"><a class="header" href="#seven-segment-1">Seven Segment</a></h2>
<pre><code class="language-c">/// Writes a number to the Seven Segment Display.
///
/// Displays numbers in base 10 or base 16
///
/// Safety note:
///		if the number does not fit (&gt; 6 digits) memory issues could arise
///     as sprintf() is used internally 
///
/// Ex.
///		write_hex_display(10, 10)  will display `10`
///		write_hex_display(10, 16)  will display `A`
///
/// @param int num: The number to write
/// @param int base: The base of the num. Valid for `10` and `16`
/// @return number of digits written. -1 on error
int write_hex_display(int num, int base);

/// Clears the Seven Segment Display.
void clear_hex_display(void);

/// Writes a digit to one of the cells of the Display.
///
/// @param char: the 4-bit number to display
/// @param int: the cell to write to. Valid for 0-5
void write_hex(char, int);

/// Clears one of the cells of the Display
///
/// @param int: The cell to clear. Valid for 0-5
void clear_hex(int block);
</code></pre>
<h2 id="servo-1"><a class="header" href="#servo-1">Servo</a></h2>
<pre><code class="language-c">#define SERVO_0 0
#define SERVO_1 8

/// moves the servo based of the raw_value
/// 
/// @param servo: Should be `SERVO_0` or `SERVO_1`
/// @param raw_value: value from 0-255. See module documentation
///                   for more info on accepted values.
void move_servo(char servo, char raw_value);

/// moves the servo using degrees instead of a raw_value
///
/// @param servo: should be `SERVO_0` or `SERVO_1`
/// @param degree: the number of degrees to move the servo
void move_servo_degree(char servo, char degree);

/// moves both servos in one call
///
/// same as calling 
/// ```
/// move_servo(SERVO_0, raw_value_0);
/// move_servo(SERVO_1, raw_value_1);
/// ``` 
void move_servos(char raw_value_0, char raw_value_1);

/// moves both servos in one call
///
/// same as calling 
/// ```
/// move_servo(SERVO_0, degree_0);
/// move_servo(SERVO_1, degree_1);
/// ``` 
void move_servos_degree(char degree_0, char degree_1);
</code></pre>
<h2 id="lcd-display-1"><a class="header" href="#lcd-display-1">LCD Display</a></h2>
<pre><code class="language-c">/// Display height
#define HEIGHT 240

/// Display width
#define WIDTH  320

/// Some basic colors
#define WHITE 0xFFFFFF
#define BLACK 0x000000
#define RED   0xFF0000
#define GREEN 0x00FF00
#define BLUE  0x0000FF

/// Initializes the display
///
/// Safety:
/// Allocates memory for the frame buffer that must be freed
void lcd_init(void);

/// Sets every pixel on the display to a color
///
/// @param color: the color
void lcd_fill(int color);

/// Sets the color of a pixel
///
/// (0, 0) is the top left corner of the screen
///
/// @param x: the x coordinate
/// @param y: the y coordinate
/// @param color: the color
void set_pixel(unsigned int x, unsigned int y, int color);

/// Draws a line to the screen
///
/// @param x0: x top left point
/// @param y0: y top left point
/// @param x1: x bottom right point
/// @param y1: y bottom right point
/// @param color: the color
/// @param fill: fill the rectangle
void draw_rectangle(int x0, int y0, int x1, int y1, int color, bool fill);

/// Draws a line to the screen
///
/// @param x0: x start point
/// @param y0: y start point
/// @param x1: x end point
/// @param y1: y end point
/// @param color: the color
void draw_line(int x0, int y0, int x1, int y1, int color);

/// Presents the changes to the back buffer to the screen
void lcd_present(void);

/// Frees the memory that the LCD's framebuffer was using
void lcd_free(void);

/// Clears the LCD's front and back buffer
void lcd_clear(void);
</code></pre>
<h2 id="lcd-touch-1"><a class="header" href="#lcd-touch-1">LCD Touch</a></h2>
<pre><code class="language-c">/// Initializes touch capabilities of the LCD.
/// Must have called `lcd_init()` before
void touch_init(void);

/// Gets the coordinate of the last touch on the LCD
///
/// @param storage: pointer to store [x, y]
void get_touch_data(int32_t storage[2]);
</code></pre>
<h2 id="analog-joystick"><a class="header" href="#analog-joystick">Analog Joystick</a></h2>
<pre><code class="language-c">#define ANALOG_THRESHOLD 10

/// Initializes the ADC's used by the analog stick
void analog_init(void);

/// Reads the analog stick data.
/// Each component will be on the range of -100 to 100
///
/// @param storage: where to store [x, y]
void get_analog_data(int32_t storage[2]);
</code></pre>
<h2 id="accelerometer-1"><a class="header" href="#accelerometer-1">Accelerometer</a></h2>
<pre><code class="language-c">/// Initializes the accelerometer
///
/// @return 0 on success else -1
int accel_init(void);

/// Retrieves data from the accelerometer
///
/// @param storage: array to store [x, y, z] data
/// @return 0 on success else -1
int get_accel_data(int16_t storage[3]);
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="appendix-ii-example"><a class="header" href="#appendix-ii-example">Appendix II: Example</a></h1>
<pre><code class="language-c">#include &quot;led.h&quot;
#include &quot;pushbutton.h&quot;
#include &quot;switches.h&quot;
#include &quot;seven_seg.h&quot;
#include &quot;servo.h&quot;
#include &quot;lcd.h&quot;
#include &quot;touch.h&quot;
#include &quot;analog.h&quot;
#include &quot;accel.h&quot;

#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

typedef struct AppState
{
  int32_t joystick[2];
  int16_t accelerometer[3];
  int32_t touch_data[2];
  int16_t led_value;
  int32_t last_switch;
} AppState;

/// Sets the min and max value of a number
static void clamp(int32_t *val, int32_t min, int32_t max)
{
  if (*val &gt; max)
  {
    *val = max;
  }
  else if (*val &lt; min)
  {
    *val = min;
  }
}

/// prints data from the accelerometer to stdout if Button 1 is pressed
void print_accel(AppState *state)
{
  if (is_button_pressed(BUTTON_1))
  {
    printf(&quot;X: %10d, Y: %10d, Z: %10d\n&quot;, state-&gt;accelerometer[0], state-&gt;accelerometer[1], state-&gt;accelerometer[2]);
    usleep(10000);
  }
}

/// Displays the last location touched
void display_seven_seg(AppState *state)
{
  int number = state-&gt;touch_data[0] * 1000 | state-&gt;touch_data[1];
  write_hex_display(number, 10);
}

// The LED that is on is controlled by the analog stick
void drive_leds(AppState *state)
{
  const int min = 0x001;
  const int max = 0x200;

  if (state-&gt;joystick[0] &gt; ANALOG_THRESHOLD)
    state-&gt;led_value &gt;&gt;= 1;
  else if (state-&gt;joystick[0] &lt; -ANALOG_THRESHOLD)
    state-&gt;led_value &lt;&lt;= 1;

  clamp((int32_t *)&amp;state-&gt;led_value, min, max);

  write_leds(state-&gt;led_value);
}

// Draws randomly colored lines to screen
void draw_screen(void)
{
  for (int i = 0; i &lt; WIDTH - 1; i++)
  {
    int color = rand() &amp; 0xFFFFFF;
    draw_line(i, 0, i, HEIGHT - 1, color);
  }

  lcd_present();
}

// Move the servos to random positions
void control_servos(void)
{
  int a = rand() &amp; 0xFF;
  int b = rand() &amp; 0xFF;

  move_servos(a, b);
}

void print_switches(AppState *state)
{
  int read = read_switches();

  if (read != state-&gt;last_switch)
  {
    state-&gt;last_switch = read;
    printf(&quot;Switches changed: %d\n&quot;, read);
  }
}

int main()
{
  // initialize subsystems
  analog_init();
  accel_init();
  lcd_init();
  touch_init();

  AppState state = {.led_value = 1};

  draw_screen();

  while (1)
  {
    // poll data from peripherals
    get_analog_data(state.joystick);
    get_accel_data(state.accelerometer);
    get_touch_data(state.touch_data);

    // call routines
    print_accel(&amp;state);
    display_seven_seg(&amp;state);
    drive_leds(&amp;state);
    control_servos();
    print_switches(&amp;state);
  }

  return 0;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
